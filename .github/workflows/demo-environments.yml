name: Demo deploy environments

on:
  workflow_dispatch: 
    inputs:
      environment:
        type: choice
        options:
          - Test
          - Staging
          - Production

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Build
        run: echo Building the app...

  test:
    runs-on: ubuntu-latest
    steps:
      - name: Test
        run: echo Tesing the app...

  deployment:
    runs-on: ubuntu-latest
    needs: [build, test]
    environment: ${{ inputs.environment }}
    steps:
      - name: Deploying feature
        run: echo Feature is being deployed
        if: ${{ vars.FEATURE_FLAG == 'true' }}
      - name: Show message
        run: echo Feature is not being deployed
        if: ${{ vars.FEATURE_FLAG == 'false' }}
      - name: Show db password
        run: echo ${{ secrets.DB_PASSWORD }}
        
